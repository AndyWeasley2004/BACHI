<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
    <meta name="description"
          content="BACHI: Boundary-aware symbolic chord recognition with masked iterative decoding on classical and pop music.">
    <meta name="keywords" content="Symbolic Chord Recognition, POP909-CL, Mask Filling">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>BACHI: Boundary-Aware Symbolic Chord Recognition</title>  

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


  <section class="hero publication-header">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">BACHI: Boundary-Aware Symbolic Chord Recognition Through Masked Iterative Decoding on Pop and Classical Music</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block"><a href="https://andyweasley2004.github.io/" target="_blank">Mingyang Yao</a>,</span>
              <span class="author-block"><a href="https://www.knutchen.com/" target="_blank">Ke Chen</a>,</span>
              <span class="author-block"><a href="http://dub.ucsd.edu/" target="_blank">Shlomo Dubnov</a>,</span>
              <span class="author-block"><a href="https://cseweb.ucsd.edu/~tberg/" target="_blank">Taylor Berg-Kirkpatrick</a></span>
            </div>
            <div class="is-size-5 publication-authors">
              <span class="author-block">University of California San Diego</span>
            </div>
              <div class="publication-links">
                
            <span class="link-block">
                <a href="https://arxiv.org/abs/2510.06528" target="_blank" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon"><i class="fas fa-file-pdf"></i></span>
                <span>arXiv</span>
              </a>
            </span>
            <span class="link-block">
                <a href="https://github.com/AndyWeasley2004/BACHI_Chord_Recognition" target="_blank" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon"><i class="fab fa-fw fa-github"></i></span>
                <span>Code</span>
              </a>
            </span>
            <span class="link-block">
                <a href="https://github.com/AndyWeasley2004/POP909-CL-Dataset" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon"><i class="fas fa-music"></i></span>
                  <span>POP909-CL</span>
                </a>
            </span>
            <span class="link-block">
                <a href="https://huggingface.co/datasets/Itsuki-music/BACHI_Chord_Recognition" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <img src="./static/images/huggingface.svg" alt="Hugging Face Icon" class="icon-img">
                  </span>
                  <span>Hugging Face</span>
                </a>
            </span>
          </div>
        </div>
      </div>
    </div>
  </section>


<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content has-text-centered">
          <div class="method-figure">
            <img src="static/images/architecture.png" alt="BACHI architecture overview" class="center-image"/>
          </div>
          <div class="content has-text-justified" style="margin-top: 1.5rem;">
            <p>
              <strong>BACHI</strong> introduces a boundary-aware approach to symbolic chord recognition that mirrors human ear-training practices. The model decomposes chord recognition into explicit steps: detecting chord boundaries, then iteratively predicting root, quality, and bass in confidence order.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Paper abstract -->
<section class="section hero is-light" id="abstract">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
Automatic chord recognition (ACR) via deep learning models has gradually achieved promising recognition accuracy, yet two key challenges remain. First, prior work has primarily focused on audio-domain ACR, while symbolic music (e.g., score) ACR has received limited attention due to data scarcity. Second, existing methods still overlook strategies that are aligned with human music analytical practices. To address these challenges, we make two contributions: (1) we introduce POP909-CL, an enhanced version of POP909 dataset with tempo-aligned content and human-corrected labels of chords, beats, keys, and time signatures; and (2) we propose BACHI, a symbolic chord recognition model that decomposes the task into different decision steps, namely boundary detection and iterative ranking of chord root, quality, and bass (inversion). This mechanism mirrors the human ear-training practices. Experiments demonstrate that BACHI achieves state-of-the-art chord recognition performance on both classical and pop music benchmarks, with ablation studies validating the effectiveness of each module.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->


<!-- Spacer before method section -->

<section class="section hero is-small" id="method">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Method</h2>
          <!-- <div class="method-figure">
            <img src="static/images/architecture.png" alt="BACHI architecture" class="center-image"/>
          </div> -->
          <div class="level-set has-text-justified">
            <p>BACHI performs symbolic chord recognition in two boundary-aware stages that mirror human ear-training.</p>
            <ul>
              <li><strong>Patch Embedding & Transformer Encoder:</strong> Beat-synchronous piano-roll tokens are embedded on both piano-roll frame and time dimensions and processed by six transformer encoder layers.</li>
              <li><strong>Boundary-Conditioned Context:</strong> A supervised chord boundary detector modulates encoder hidden states through FiLM and a local context window.</li>
              <li><strong>Confidence-Ordered Decoding:</strong> A masked transformer decoder iteratively fills root, quality, and bass in confidence order, providing robust chord labeling.</li>
            </ul>
            <p><strong>Training Data: </strong> <a href="https://github.com/AndyWeasley2004/POP909-CL-Dataset" target="_blank">POP909-CL</a> with human-corrected annotations and a curated classical corpus combining <a href="https://github.com/MarkGotham/When-in-Rome/tree/master/Corpus" target="_blank">When-in-Rome</a> and <a href="https://github.com/orgs/DCMLab/repositories?type=all" target="_blank">DCML</a>with deduplication.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section hero is-small is-light" id="results">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Results</h2>
          <div class="results-block">
            <h3 class="title is-4">Qualitative Examples</h3>
            <div class="method-figure" style="margin-bottom: 2rem;">
              <img src="static/images/demo_image.png" alt="BACHI predictions on classical and pop music examples" class="center-image"/>
            </div>
            <p class="caption">Example predictions from BACHI on classical music (top) and POP909-CL (bottom), comparing ground truth annotations with model predictions.</p>
          </div>
          <div class="results-block">
            <h3 class="title is-4">Ablation on Classical &amp; Pop</h3>
            <p>We perform a comprehensive ablation study on both classical and pop music benchmarks. We report the per-piece macro accuracy (%) across classical and POP909-CL ablations. The following is the detailed ablation study:</p>
            <ul>
              <li>BACHI w/o BD &amp; ID: We use the patch embedding and transformer encoder modules only (no <strong>boundary-aware detection</strong> and <strong>iterative decoding</strong>).</li>
              <li>BACHI w/o ID: We use the patch embedding, transformer encoder and boundary-aware detection modules only (no <strong>iterative decoding</strong>).</li>
              <li>BACHI + Key Detection: On top of complete BACHI, we add a key detection module and use the key detection result to guide the iterative decoding like boundary</li>
              <li>BACHI (Full): We use the full BACHI model (patch embedding, transformer encoder, boundary-aware detection, and iterative decoding).</li>
            </ul>
            <div class="results-carousel" id="ablation-carousel">
              <div class="item">
                <div class="results-table-wrapper">
                  <table class="results-table results-table--compact">
                    <thead>
                      <tr>
                        <th colspan="5" class="table-caption", style="text-align: center;">Classical Corpus</th>
                      </tr>
                      <tr>
                        <th><strong>Model Variant</strong></th>
                        <th><strong>Root</strong></th>
                        <th><strong>Quality</strong></th>
                        <th><strong>Bass</strong></th>
                        <th class="full-col"><strong>Full</strong></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>BACHI w/o BD &amp; ID</strong></td>
                        <td><strong>78.0</strong></td>
                        <td>78.9</td>
                        <td><strong>77.3</strong></td>
                        <td class="full-col">66.1</td>
                      </tr>
                      <tr>
                        <td><strong>BACHI w/o ID</strong></td>
                        <td>77.8</td>
                        <td>78.8</td>
                        <td>76.8</td>
                        <td class="full-col">65.6</td>
                      </tr>
                      <tr>
                        <td><strong>BACHI + Key Detection</strong></td>
                        <td>77.4</td>
                        <td>78.6</td>
                        <td>76.4</td>
                        <td class="full-col">67.6</td>
                      </tr>
                      <tr>
                        <td><strong>BACHI (Full)</strong></td>
                        <td>77.8</td>
                        <td><strong>79.0</strong></td>
                        <td>77.0</td>
                        <td class="full-col"><strong>68.1</strong></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="item">
                <div class="results-table-wrapper">
                  <table class="results-table results-table--compact">
                    <thead>
                      <tr>
                        <th colspan="5" class="table-caption", style="text-align: center;">POP909-CL</th>
                      </tr>
                      <tr>
                        <th><strong>Model Variant</strong></th>
                        <th><strong>Root</strong></th>
                        <th><strong>Quality</strong></th>
                        <th><strong>Bass</strong></th>
                        <th class="full-col"><strong>Full</strong></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><strong>BACHI w/o BD &amp; ID</strong></td>
                        <td>90.1</td>
                        <td>86.8</td>
                        <td>91.8</td>
                        <td class="full-col">82.1</td>
                      </tr>
                      <tr>
                        <td><strong>BACHI w/o ID</strong></td>
                        <td><strong>90.3</strong></td>
                        <td><strong>87.0</strong></td>
                        <td><strong>92.1</strong></td>
                        <td class="full-col">82.3</td>
                      </tr>
                      <tr>
                        <td><strong>BACHI + Key Detection</strong></td>
                        <td>89.3</td>
                        <td>86.3</td>
                        <td>90.7</td>
                        <td class="full-col">81.4</td>
                      </tr>
                      <tr>
                        <td><strong>BACHI (Full)</strong></td>
                        <td>89.5</td>
                        <td>86.8</td>
                        <td>91.3</td>
                        <td class="full-col"><strong>82.4</strong></td>
                      </tr>
                    </tbody>
                  </table>
          </div>
        </div>
      </div>
          <p class="caption">While boundary detection alone makes unstable effects on the model, the iterative decoding has a larger influence on the performance, indicating that iterative decoding across chord elements contributes significantly to overall accuracy. Interestingly, adding key detection as an additional conditioning signal slightly decreases full-chord accuracy compared to the full BACHI, likely due to errors in key prediction propagating to chord recognition.</p>
      </div>

      <div class="results-block">
        <h3 class="title is-4">Benchmark Comparison</h3>
        <div class="results-table-wrapper">
          <table class="results-table results-table--compact">
            <thead>
              <tr>
                <th rowspan="2">#</th>
                <th rowspan="2">Model</th>
                <th colspan="4" class="has-text-centered"><strong>Classical Corpus</strong></th>
                <th colspan="4" class="has-text-centered"><strong>POP909-CL</strong></th>
              </tr>
              <tr>
                <th><strong>Root</strong></th>
                <th><strong>Quality</strong></th>
                <th><strong>Bass</strong></th>
                <th class="full-col"><strong>Full</strong></th>
                <th><strong>Root</strong></th>
                <th><strong>Quality</strong></th>
                <th><strong>Bass</strong></th>
                <th class="full-col"><strong>Full</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td><a href="https://github.com/Dsqvival/hierarchical-structure-analysis/tree/main/preprocessing" target="_blank"><strong>Rule-based</strong></a></td>
                <td>54.6</td>
                <td>45.8</td>
                <td>50.5</td>
                <td class="full-col">28.4</td>
                <td>85.9</td>
                <td>69.7</td>
                <td>85.8</td>
                <td class="full-col">65.0</td>
              </tr>
              <tr>
                <td>2</td>
                <td><a href="https://archives.ismir.net/ismir2021/paper/000050.pdf" target="_blank"><strong>AugmentedNet</strong></a></td>
                <td>73.9</td>
                <td>74.2</td>
                <td>72.3</td>
                <td class="full-col">57.2</td>
                <td>88.6</td>
                <td>84.5</td>
                <td>90.5</td>
                <td class="full-col">78.7</td>
              </tr>
              <tr>
                <td>3</td>
                <td><a href="https://arxiv.org/abs/2307.03544" target="_blank"><strong>ChordGNN</strong></a></td>
                <td>73.0</td>
                <td>73.7</td>
                <td>71.0</td>
                <td class="full-col">58.5</td>
                <td>80.7</td>
                <td>82.0</td>
                <td>82.7</td>
                <td class="full-col">71.6</td>
              </tr>
              <tr>
                <td>4</td>
                <td><a href="https://transactions.ismir.net/articles/10.5334/tismir.65" target="_blank"><strong>Harmony Transformer v2</strong></a></td>
                <td>76.1</td>
                <td>76.8</td>
                <td>75.2</td>
                <td class="full-col">62.1</td>
                <td><strong>90.5</strong></td>
                <td><strong>86.9</strong></td>
                <td><strong>92.1</strong></td>
                <td class="full-col">82.2</td>
              </tr>
              <tr class="highlight-row">
                <td>5</td>
                <td><strong>BACHI (ours)</strong></td>
                <td><strong>77.8</strong></td>
                <td><strong>79.0</strong></td>
                <td><strong>77.0</strong></td>
                <td class="full-col"><strong>68.1</strong></td>
                <td>89.6</td>
                <td>86.8</td>
                <td>91.3</td>
                <td class="full-col"><strong>82.4</strong></td>
              </tr>
            </tbody>
          </table>
    </div>
            <p class="caption">For classical music, BACHI achieves the highest scores across all metrics, with a notable improvement in full chord accuracy (68.1%) over prior baselines. For pop music, BACHI achieves state-of-the-art performance, with a full chord accuracy of 82.4%. Most deep learning methods are all performing well on pop music, and though some components are not ranking at first, the full chord accuracy is still the best. Overall, these results demonstrate both the strong performance of BACHI on classical and pop music, where BACHI is particuarly good at more complex classical music.</p>
          </div>
          <div class="results-block">
            <h3 class="title is-4">Confidence-Ordered Decoding</h3>
            <div class="results-table-wrapper">
              <table class="results-table results-table--compact">
                <thead>
                  <tr>
                    <th></th>
                    <th><strong>Classical</strong></th>
                    <th><strong>POP909-CL</strong></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>Most frequent first-decoded field</strong></td>
                    <td>Quality (40.8%)</td>
                    <td>Bass (66.9%)</td>
                  </tr>
                  <tr>
                    <td><strong>Top decoding sequence</strong></td>
                    <td>Quality → Root → Bass (32.2%)</td>
                    <td>Bass → Root → Quality (56.4%)</td>
                  </tr>
                  <tr>
                    <td><strong>Interpretation</strong></td>
                    <td>Classical harmony emphasizes voice-leading and functional quality cues.</td>
                    <td>Pop arrangements highlight bass-led cues for chord identity.</td>
                  </tr>
                </tbody>
              </table>
        </div>
            <p class="caption">These genre-variant orders indicate that the model internalizes musician-like heuristics, supporting our hypothesis that human-mimicking decision paths benefit symbolic ACR and improve upon fixed-order decoding.</p>
    </div>
</section>


<section class="section hero is-small" id="takeaways">
  <div class="container is-max-desktop content">
    <h2 class="title">Main Contributions</h2>
    <ul>
      <li>We proposed POP909-CL, an enhanced version of POP909 with human-corrected labels, as a reliable resource for MIR research.</li>
      <li>We propose BACHI, a boundary-aware symbolic chord recognition model that incorporates cues and decision processes inspired by human ear-training to improve recognition accuracy.</li>
      <li>Objective evaluations demonstrate that BACHI achieves state-of-the-art performance on both classical and pop music benchmarks, with ablation studies validating the effectiveness of each module.</li>
    </ul>
  </div>
</section>

<section class="section hero is-small" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{yao2025bachi,
  author    = {Mingyang Yao and Ke Chen and Shlomo Dubnov and Taylor Berg-Kirkpatrick},
  title     = {BACHI: Boundary-Aware Symbolic Chord Recognition Through Masked Iterative Decoding on Pop and Classical Music},
  journal   = {arXiv},
  year      = {2025},
}</code></pre>
  </div>
</section>

  
<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is built with <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> and modified from <a href="https://github.com/nerfies/nerfies.github.io" target="_blank">Nerfies</a>.
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>


</body>
</html>
